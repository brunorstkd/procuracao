<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link rel="stylesheet" href="css/stylo.css" />
  <script src="js/bootstrap.min.js"></script>
  
<title>Agendamento GOL - RH</title>

</head>
<body>
<header class="o-header container-fluid text-center">
  <div class="col span_3">
    <a id="logo" href="https://online-rs.github.io/reiter-rh/" data-supplied-ml-starting-dark="false" data-supplied-ml-starting="false" data-supplied-ml="false">
      <img class="stnd default-logo dark-version" alt="REITER LOG" src="https://www.reiterlog.com/portaln/wp-content/uploads/2020/10/logistica-logo.png" srcset="https://www.reiterlog.com/portaln/wp-content/uploads/2020/10/logistica-logo.png 1x, https://www.reiterlog.com/portaln/wp-content/uploads/2020/10/logistica-logo.png 2x"> 
    </a>  
  </div>

  <h1> Canal de Atendimento - RH</h1>
  <h2>Agendamentos - GOL</h2>
  <p>Favor verificar se não há outro agendamento para mesma data  e hoário antes de finalizar</p>
</header>
<main class="o-main">
<div class="text-center">
		<div class="agendamentobox2 container">
			<div class="grupo">
      <label>Data Saída:</label>
			<input type="date" id="data-saida">
      </div>
      <div class="grupo"> 
			<label>Horário de Saída:</label>
			<input type="time" id="horario-saida">
      </div>
      <div class="grupo">
			<label>Previsão Horário Retorno:</label>
			<input type="time" id="horario-retorno">
      </div>
      <div class="grupo">
			<label>Destino:</label>
			<input type="text" id="destino">
      </div>
      <div class="grupo">
      <label>Motorista:</label>
			<input type="text" id="motorista">
      </div>
			<button id="iniciar" class="btn btn-danger btn-lg" onclick="incluirAgendamento()">Agendar</button>
		</div>
		<div class="agendamentos">
			<h2>Agendamentos</h2>
      <p>Caso seu agendamento não aparceça, <a href='https://docs.google.com/spreadsheets/d/1CPk6UmZfTCGxPukUO7Pehj5CXuPrqFkQepL3uhRGTLA/edit?usp=sharing'>clique aqui</a></p>
      <iframe id='iframe' src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQrHTG3ja4a-h8HmX0NAS2EeQBeRguIIkAhG10OXOn8CVwlCaYDFsePAmUfJtFQxFAdBQGIJbTnzUlL/pubhtml?widget=true&amp;headers=false" scrolling="yes"> </iframe>      
	</div>
	<script>
		let agendamentos = [];

		function incluirAgendamento() {
			const dataSaida = document.getElementById('data-saida').value;
			const horarioSaida = document.getElementById('horario-saida').value;
			const horarioRetorno = document.getElementById('horario-retorno').value;
			const destino = document.getElementById('destino').value;
            const motorista = document.getElementById('motorista').value;
			agendamentos.push({dataSaida, horarioSaida, horarioRetorno, destino, motorista});
			agendamentos.sort((a, b) => new Date(a.dataSaida) - new Date(b.dataSaida));
            console.log("click no botão incluir");
            event.preventDefault();
            alert('Agendamento realizado com sucesso!');
            const url = "https://hook.us1.make.com/wc6bb39rpw3dxpau2gyqbcirgd5cqxes?data=" + dataSaida + "&saida=" + horarioSaida + "&retorno=" + horarioRetorno + "&destino=" + destino + "&motorista=" + motorista;
            var xhttp = new XMLHttpRequest();
            xhttp.open("GET", url, false);
            xhttp.send();//A execução do script pára aqui até a requisição retornar do servidor
        
            console.log(xhttp.responseText);
            console.log(url)
            


            
			location.reload();
			var delayInMilliseconds = 3000; //1 second

			setTimeout(function() {
			//your code to be executed after 1 second
			}, delayInMilliseconds);
      document.getElementById('iframe').contentDocument.location.reload(true);

		};
	</script>




</main>
<footer class="o-footer text-center">
  <p>Desenvolvido por Bruno de Oliveira.</p>
</footer>
<script src="js/script.js"></script>
</body>
</html>
